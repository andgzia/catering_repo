/*jshint strict: false, undef: false, trailing: false, curly: false, nomen: false, expr: true, onecase: true, eqeqeq: false, eqnull: true, white: false, array: false, asi: true, plusplus: false, laxcomma: true, laxbreak: true, shadow: true, smarttabs: false, supernew: true, nonew: false, funcscope: true, forin: false */
/** WHEN EDITING FILE REPLACE WITH: /  strict:false */
/*global mns: true, jQuery: true, testMode: true, log: true*/

/*
File: mns.bizUnitType.js
Functions around the bizUnitType selector
*/
(function (bizUnitType, WIN, jQuery, t, undefined){ /* Namespace : mns.bizUnitType */

    bizUnitType.object,
    bizUnitType.switchElement,

    /*
    Function: mns.bizUnitType.init
    Run one off d,pendencies (eg: subscriptions) then destroy

    Returns:
    boolean - true if reaches end
    */
    bizUnitType.init = function (){
        mns.msg.pub('/log','mns.bizUnitType.init');
        return bizUnitType.init = function(){
            mns.msg.pub('/log','mns.bizUnitType.init does not need to run again');
            return true;
        };
    };

    /*
    Function: mns.bizUnitType.begin
    */
    bizUnitType.begin = function ($el){
        bizUnitType.object = $el;
        $el.delegate('li', 'click', this.onClick);
        bizUnitType.switcher($el.children('.active'));
    };
    
    bizUnitType.onClick = function(){
        var $this = $(this);
        if($this.hasClass('active')){
            return false;
        } else {
            $this.addClass('active');
            $this.siblings().removeClass('active');
        }
        bizUnitType.switcher($this);
    };

    bizUnitType.switcher = function($el) {

        unitElements = bizUnitType.object.data('unit-elements');
        clickedSizeGuide = $el.closest(".product-information-flyout").data("panel-id");

        for(element in unitElements) {

            bizUnitType.switchElement = $("[data-panel-id=" + clickedSizeGuide + "]" + " #" + unitElements[element]);

            var thisUnit = $el.prevAll().length;
            bizUnitType.switchElement.find('span').each(function(){
                var $this = $(this);

                $this.text($(this).parent().data('units')[thisUnit]);

            });
        }

    }
    
})(mns.bizUnitType = mns.bizUnitType || {}, window, jQuery, testMode.unitType || {});